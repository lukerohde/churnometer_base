<h1>Summary</h1>

<section>
  <form action="/summary">
    <ul>
      <li>
        <label>Start Date</label>
        <input type="text" name="startDate" value="<%= @defaults['startDate'] %>">
      </li>
      <li>
        <label>End Date</label>
        <input type="text" name="endDate" value="<%= @defaults['endDate'] %>">
      </li>
      <li>
        <label>group by</label>
        <input type="text" name="group_by" value="<%= @defaults['group_by'] %>">
      </li>
      <li>
        <label>branch id</label>
        <input type="text" name="filter[branchid]" value="<%= @defaults['filter']['branchid'] %>">
      </li>
    </ul>
    <ul>
      <li><input type="submit" value="Submit"></li>
    </ul>
    
  </form>
</section>

<section>
  <% if @data && @data[0] %>
    <table>
      <tr>
        <% @data[0].each do |k, v| %>
          <th><%= k %></th>
        <% end %>
      </tr>
      <% @data.each do |row| %>
        <tr>
          <% row.each do |k, v| %>
            <td>
              <% if k == 'row_header' %>
                <% if params != {} %>
                  <a href="<%= request.url + "&row_header_id=#{row['row_header_id']}" %>"><%= v %></a>
                  <% else %>
                    <a href="<%= request.url + "?row_header_id=#{row['row_header_id']}" %>"><%= v %></a>
                  <% end %>
              <% else %>
                <%= v %>
              <% end %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </table>
  <% else %>
    <p>No data</p>
  <% end %>
</section>


